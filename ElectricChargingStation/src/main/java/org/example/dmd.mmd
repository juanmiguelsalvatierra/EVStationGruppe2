classDiagram
%% ============================================================
%% =============== DOMAIN LAYER (Fachmodell) ==================
%% ============================================================

    class Customer {
        +int customerId
        +String name
        +String email
        +updateAccount(name: String, email: String)
        +topUpBalance(amount: Double): Double
        +withdrawBalance(amount: Double): Double
        +viewBalance(): Double
    }

    class Invoice {
        +int invoiceId
        +int CustomerId
        +readInvoiceItems(): InvoiceItem[]
    }

    class InvoiceItem {
        <<abstract>>
        +String itemID
        +InvoiceItemType type
        %%means if you sum up all getBalanceAmount() Methods of all InvoiceItems you will get the current Balance
        +getBalanceAmount(): Double
    }

    class ChargingItem {
        +Double duration
        +Double pricePerKWh
        %%is always negativ since it reduces the balance
        +getBalanceAmount(): Double
    }

    class BalanceItem {
        %%amount is negative for withdraw and positive for top-up
        +Double amount 
        +getBalanceAmount(): Double
    }

    class Location {
        +int locationId
        +String address
        +String description
        +readAllCharger(): Charger[]
    }

    class Charger {
        +int chargerId
        +int LocationId
        +ChargerType type
        +Status status
        +Double kwH
        +Double pricePerKWh
    }

    class InvoiceItemType {
        <<enumeration>>
        CHARGING
        TOPUP
    }

    class ChargerType {
        <<enumeration>>
        AC
        DC
    }

    class Status {
        <<enumeration>>
        FREE
        OCCUPIED
        OUT_OF_ORDER
    }

%% ===== Vererbung im Domain Layer =====

    InvoiceItem <|-- ChargingItem
    InvoiceItem <|-- BalanceItem

%% ===== Domain-Relationen =====

    Customer "1" --> "0..*" Invoice : has
    Invoice "1" --> "1..*" InvoiceItem : contains
    Location "1" --> "0..*" Charger : provides

%% ============================================================
%% =============== REPOSITORY LAYER (Persistenz) ==============
%% ============================================================

    class CustomerRepository {
        <<interface>>
        -storage: Map
        +save(customer: Customer): Customer
        +findAll(): List
        +findById(customerId: int): Customer
        +deleteById(customerId: int)
    }

    class InvoiceRepository {
        <<interface>>
        -storage: Map
        +save(invoice: Invoice): Invoice
        +findById(invoiceId: int): Invoice
        +findByCustomerId(customerId: int): List
    }

    class LocationRepository {
        <<interface>>
        -storage: Map
        +save(location: Location): Location
        +findAll(): List
        +findById(locationId: int): Location
    }

    class ChargerRepository {
        <<interface>>
        -storage: Map
        +save(charger: Charger): Charger
        +findById(chargerId: int): Charger
        +findByLocationId(locationId: int): List
    }

%% ============================================================
%% =============== SERVICE LAYER (Fachlogik) ==================
%% ============================================================

    class CustomerService {
        +createCustomer(name: String, email: String): Customer
        +updateCustomer(customerId: int, name: String, email: String): Customer
        +deleteCustomer(customerId: int): Customer
        +getAllCustomers(): List<Customer>
        +getCustomerById(customerId: int): Customer
        +topUpBalance(customerId: int, amount: Double)
        +withdrawBalance(customerId: int, amount: Double)
    }

    class InvoiceService {
        +createInvoice(customerId: int): Invoice
        +getInvoice(invoiceId: int): Invoice
        +getInvoiceForCustomer(customerId: int): Invoice
        +getAllInvoices(): List<Invoice>
        +addChargingItem(invoiceId: int, duration: Double, pricePerKWh: Double): ChargingItem
        +addBalanceItem(invoiceId: int, amount: Double): BalanceItem
        +calculateTotal(invoiceId: int): Double
    }

    class LocationService {
        +createLocation(address: String, description: String): Location
        +updateLocation(locationId: int, address: String, description: String): Location
        +deleteLocation(locationId: int): Location
        +getAllLocations(): List
        %%List with all Locations and their Chargers
        +getStationNetwork(): Map
        +getLocation(locationId: int): Location
    }

    class ChargerService {
        +createCharger(locationId: int, type: ChargerType, kwH: Double, pricePerKWh: Double): Charger
        +updateChargerStatus(chargerId: int, status: Status): Charger
        +deleteCharger(chargerId: int): Charger
        +getChargersForLocation(locationId: int): List
        +getCharger(chargerId: int): Charger
    }

%% ============================================================
%% ========================== Main ============================
%% ============================================================

class ElectricChargingStationApp {
    +main(args: String[])
}

%% ===== Service -> Main Abhängigkeiten =====
    CustomerService ..> ElectricChargingStationApp
    InvoiceService ..> ElectricChargingStationApp   
    LocationService ..> ElectricChargingStationApp
    ChargerService ..> ElectricChargingStationApp


%% ===== Service -> Repository Abhängigkeiten =====

    CustomerService ..> CustomerRepository
    InvoiceService ..> InvoiceRepository
    InvoiceService ..> CustomerRepository
    LocationService ..> LocationRepository
    ChargerService ..> ChargerRepository
    ChargerService ..> LocationRepository

%% ===== Services arbeiten auf Domain-Objekten =====

    CustomerService --> Customer : manages
    InvoiceService --> Invoice : manages
    InvoiceService --> InvoiceItem : manages
    LocationService --> Location : manages
    ChargerService --> Charger : manages
